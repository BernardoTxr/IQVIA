{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Adicionar tipo de desconto"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests\n",
    "import json\n",
    "import pandas as pd\n",
    "import re\n",
    "from bs4 import BeautifulSoup\n",
    "import asyncio\n",
    "import aiohttp"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Scrapping Drogasil\n",
    "O Scrapping será realizado por objetos da classe Scrapper em 2 etapas:\n",
    "1. mainScrapper: objeto responsável por iterar nas URLS das páginas de medicamento da Drogasil, selecionando o URLS de todos os produtos.\n",
    "2. individualScrapper: objeto responsável por iterar nas URLS selecionadas pelo mainScrapper. Realizará a seleção de informações relevantes."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Criação da Classe Scraper, responsável por realizar os scrappers assíncronos na página."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "class Scraper(object):\n",
    "\n",
    "    '''\n",
    "    Função de Inicialização\n",
    "    '''\n",
    "    def __init__(self, urls):\n",
    "        # Urls são passadas para o objeto\n",
    "        self.urls = urls\n",
    "        # Local geral para armazenamento de dados\n",
    "        self.all_data = []\n",
    "        # Dicionário para armazenar os dados coletados com a URL como chave\n",
    "        self.master_dict = {}\n",
    "        # Rodar o scrapper:\n",
    "        asyncio.run(self.main())\n",
    "\n",
    "    '''\n",
    "    Função fetch que realiza a solicitação HTTP assíncrona\n",
    "    '''\n",
    "    async def fetch(self, session, url):\n",
    "        try:\n",
    "            async with session.get(url) as response:\n",
    "                text = await response.text()\n",
    "                return text, url\n",
    "        except Exception as e:\n",
    "            print(str(e))\n",
    "    \n",
    "    '''\n",
    "    Função main orquestradora\n",
    "    '''\n",
    "    async def main(self):\n",
    "        tasks = []\n",
    "        headers = {\n",
    "            'authority': 'www.drogasil.com.br',\n",
    "            'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',\n",
    "            'accept-language': 'pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7',\n",
    "            'cache-control': 'no-cache',\n",
    "            'cookie': 'rrsession=h28ab332b1ca89150d91a; nav_id=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_p=20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_browserId=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_c=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_s=20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_anonymousUserId=anon-20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_testGroup=%7B%22experiment%22%3Anull%2C%22group%22%3Anull%2C%22testCode%22%3Anull%2C%22code%22%3Anull%2C%22session%22%3Anull%7D; guesttoken=ceksHPxt7i8UNdQcF6rFTOgbju2khBxJ; carttoken=ceksHPxt7i8UNdQcF6rFTOgbju2khBxJ; _gid=GA1.3.1680432160.1704587891; _rlu=47ba54e2-e976-4c22-87e4-e560bb2c4464; _rl_rl=0; _rlgm=7DD2zwA|y|11SvYaIv|z69E44GpO:y/k2DJBp5wr:y/k2B07zLgv:y/83Kqr1lP3:y/jY6vPp564:y/GRWzMj7JJ:y/XQpqOOPVl:y/r2V7glXWL:y/57K0OWEvx:y/oZXnvyODK:y/pZLoRznJ1:y/Br9YMo1rN:y/vQLyJQOyr:y/99YWAZ9lx:y/28Dm1NPyP:y/z6YM6PBq8:y|; _rllt=1704587891423; _rll_c_2267_d=1704587891429; _rll_c_2267_c=0; _rll_c_2267_sc=0; _rll_c_2267_sd=1704587891429; _tt_enable_cookie=1; _ttp=uzdapl01ydHOV-Bu2oxlWhhG0Lv; _pin_unauth=dWlkPU5URXhNVFJpT1RrdFpUUXhZUzAwT1RsbExXRTNPR0V0TVRKbFpEQXdOMlU1T0RVeA; _rlsnk=47ba_lr2rmci4; _gcl_au=1.1.1599598983.1704587894; blueID=c6fbd7b8-b313-4c10-9de6-ccfafc7504c1; user_unic_ac_id=8ceddb0d-c39c-cb32-463b-45e807d7f264; advcake_trackid=7aa5faa6-8b89-5bf6-59aa-1bd69c99aba0; OptanonAlertBoxClosed=2024-01-07T00:38:17.147Z; _rll__sel10s_d=1704587916581; _rll__sel10s_c=1; _rll__sel10s_sc=1; _rll__sel10s_sd=1704587916581; _rll__sel20s_d=1704587916584; _rll__sel20s_c=1; _rll__sel20s_sc=1; _rll__sel20s_sd=1704587916584; _rll_sc_1622_c=0; _rll__sel30s_d=1704588009841; _rll__sel30s_c=1; _rll__sel30s_sc=1; _rll__sel30s_sd=1704588009841; _rll__sel40s_d=1704588009843; _rll__sel40s_c=1; _rll__sel40s_sc=1; _rll__sel40s_sd=1704588009843; _rll__sel50s_d=1704588009845; _rll__sel50s_c=1; _rll__sel50s_sc=1; _rll__sel50s_sd=1704588009845; _rll__sel1m_d=1704588009846; _rll__sel1m_c=1; _rll__sel1m_sc=1; _rll__sel1m_sd=1704588009846; _rll_c_1813_d=1704588024848; _rll_c_1813_c=1; _rll_c_1813_sc=1; _rll_c_1813_sd=1704588024848; _rll__sel2m_d=1704588080161; _rll__sel2m_c=1; _rll__sel2m_sc=1; _rll__sel2m_sd=1704588080161; _hjSessionUser_557741=eyJpZCI6IjU2NDk4NDk0LWNjMDgtNWU3Mi05NWNkLWJlNjFmZGE1NjE3NiIsImNyZWF0ZWQiOjE3MDQ1ODgwMTIwOTksImV4aXN0aW5nIjp0cnVlfQ==; _rll__sel5m_d=1704593267364; _rll__sel5m_c=1; _rll__sel5m_sc=1; _rll__sel5m_sd=1704593267364; _rll__sel10m_d=1704593267365; _rll__sel10m_c=1; _rll__sel10m_sc=1; _rll__sel10m_sd=1704593267365; _rll__sel30m_d=1704593267366; _rll__sel30m_c=1; _rll__sel30m_sc=1; _rll__sel30m_sd=1704593267366; _rll__sel60m_d=1704593267367; _rll__sel60m_c=1; _rll__sel60m_sc=1; _rll__sel60m_sd=1704593267367; rcsicons=eF4Vx7sNgDAQBNHEEb2sdMt9fHRAGzZOCMiA-jEa6UlTluu9zyHUVLCKxV-k-DyA5Tn2xq1n1QFzKsyYyNEIkVBNt3X6AWWbEGw; mmapi.p.bid=%22prodiadcgus02%22; mmapi.p.srv=%22prodiadcgus02%22; rcsproducts=eF4Vx7ERgDAIBdAmlbv8uxAIgQ1cQyGFhZ06v3qvemU5n-vISmwMGlX0Z_qtC0DljnWLpvvMgXDfIG0GqmcHmTJbFwrPF4KDEdI; impulsesuite_session=1704646471995-0.10658159894229269; chaordic_session=1704646472287-0.06931777319778276; _rll_c_1622_d=1704646473999; _rll_c_1622_sc=2; _rll_c_1622_sd=1704646473999; _rll_c_1622_c=0; _hjIncludedInSessionSample_557741=0; _hjSession_557741=eyJpZCI6IjFkZDYxMDM5LWI0NjAtNGYwMi1iZmJhLTBkNmE1ZWFmYzE3MCIsImMiOjE3MDQ2NDY1MjMxMzAsInMiOjAsInIiOjAsInNiIjowfQ==; _hjAbsoluteSessionInProgress=0; rcspdp=eF4NxLENgDAMBMAmFbs8wvZjOxswRwiRKOiA-eGKK-XZt9Fr09UVzEGwtr_MgNLNMpocotP13mefxdIgsdDp6WpqICAfbDEQqQ; mmapi.p.pd=%22dt2xbRiKUUDUSN1thEBCy_6hE3opjyWfV_lH5uI8PIw%3D%7CHgAAAApDH4sIAAAAAAAEAGNheD4pcJq7xM49DMyZiSmMQgyMTgwqTLNfsDEsPL6yYhH_HY-izRqvJIA0AxD8hwIGNpfMotTkEkZ3CTaQOBjAJEE0VIjRFQA25gtUYQAAAA%3D%3D%22; _ga=GA1.1.1543159432.1704587890; _ga_5J2QJPHWJP=GS1.1.1704646471.6.1.1704646973.35.0.0; cto_bundle=oHRiD19ZalZNVllDJTJCTWQyRXMwVzdvaFluN0JCVTJnZ1NPbElKdzBmTEl1WHRub255MHN6SXEwSXF4VUJLdDRodHJJZXJIV1pDc2d4VE9seWV2Z1lOUlglMkZWcUdVSVNGSWlXR2lSSXBJeWJvaXF2YlJTbTk5ckhXUFozMlJ2c1Y3NllKTFZqd1VnVnhCUkIxTm5wdCUyQmtWSFBXJTJCdzZpZXoxUFYlMkY4TEQwTG9mMXFQTW8zOWJZV01JdnJQaEJPM1JaWElnbDI1MXJ4TThtVkVFcHdZdjFja1B2Z1ByQVdpciUyRmg5WmRvYk4zZUdBU2d4M1FtQWhyJTJGZXJPaXhBbkJUdGtQOVpKc2UyY3RMcTdSOG9FR2RhWUIlMkZ4ZVM1QSUyRk0lMkY4cG41cDBMTG8lMkJaSUw2ODllOFZUdUxFeGhKJTJCSmJOM05tdmhPOFBaSQ; OptanonConsent=isIABGlobal=false&datestamp=Sun+Jan+07+2024+14%3A02%3A54+GMT-0300+(Brasilia+Standard+Time)&version=6.22.0&hosts=&consentId=af2697d4-7a7e-43f2-a718-4ffd2dcf34e5&interactionCount=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0002%3A1%2CC0003%3A1%2CC0004%3A1%2CC0008%3A1&geolocation=BR%3BSP&AwaitingReconsent=false; _dc_gtm_UA-69376920-3=1; _dd_s=rum=0&expire=1704648022438; rcspdp=eF5j4cotK8lM0TM0tjDWNTQ3MDEzNjU2MzIwMNI10dU1ZClN9khLsUwyMjUDClikmeiaWCYBCQsLc10joFpjC_Mkw1RDIwBZ5RCc',\n",
    "            'pragma': 'no-cache',\n",
    "            'sec-ch-ua': '\"Not_A Brand\";v=\"8\", \"Chromium\";v=\"120\", \"Google Chrome\";v=\"120\"',\n",
    "            'sec-ch-ua-mobile': '?0',\n",
    "            'sec-ch-ua-platform': '\"Windows\"',\n",
    "            'sec-fetch-dest': 'document',\n",
    "            'sec-fetch-mode': 'navigate',\n",
    "            'sec-fetch-site': 'same-origin',\n",
    "            'sec-fetch-user': '?1',\n",
    "            'upgrade-insecure-requests': '1',\n",
    "            'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'\n",
    "        }\n",
    "        async with aiohttp.ClientSession(headers=headers) as session:\n",
    "            # Itera sobre todos os URLS passados\n",
    "            for url in self.urls:\n",
    "                # Adiciona a tarefa assíncrona à lista de tarefas tasks\n",
    "                tasks.append(self.fetch(session, url))\n",
    "            # Gather realiza as tarefas assíncronas em paralelo e coloca os resultados em htmls\n",
    "            htmls = await asyncio.gather(*tasks)\n",
    "            # Adiciona os resultados à lista all_data\n",
    "            self.all_data.extend(htmls)\n",
    "\n",
    "            # Itera sobre todos os htmls e coloca no dicionário\n",
    "            for html in htmls:\n",
    "                if html is not None:\n",
    "                    url = html[1]\n",
    "                    self.master_dict[url] = {'Html': html[0]}\n",
    "                else:\n",
    "                    continue"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Primeiro Scrapping com o objeto mainScrapping:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['https://www.drogasil.com.br/medicamentos.html?p=1', 'https://www.drogasil.com.br/medicamentos.html?p=2', 'https://www.drogasil.com.br/medicamentos.html?p=3', 'https://www.drogasil.com.br/medicamentos.html?p=4', 'https://www.drogasil.com.br/medicamentos.html?p=5', 'https://www.drogasil.com.br/medicamentos.html?p=6', 'https://www.drogasil.com.br/medicamentos.html?p=7', 'https://www.drogasil.com.br/medicamentos.html?p=8', 'https://www.drogasil.com.br/medicamentos.html?p=9', 'https://www.drogasil.com.br/medicamentos.html?p=10', 'https://www.drogasil.com.br/medicamentos.html?p=11', 'https://www.drogasil.com.br/medicamentos.html?p=12', 'https://www.drogasil.com.br/medicamentos.html?p=13', 'https://www.drogasil.com.br/medicamentos.html?p=14', 'https://www.drogasil.com.br/medicamentos.html?p=15', 'https://www.drogasil.com.br/medicamentos.html?p=16', 'https://www.drogasil.com.br/medicamentos.html?p=17', 'https://www.drogasil.com.br/medicamentos.html?p=18', 'https://www.drogasil.com.br/medicamentos.html?p=19', 'https://www.drogasil.com.br/medicamentos.html?p=20']\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<frozen genericpath>:77: RuntimeWarning: coroutine 'Scraper.main' was never awaited\n",
      "RuntimeWarning: Enable tracemalloc to get the object allocation traceback\n"
     ]
    },
    {
     "ename": "RuntimeError",
     "evalue": "asyncio.run() cannot be called from a running event loop",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mRuntimeError\u001b[0m                              Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[16], line 8\u001b[0m\n\u001b[0;32m      5\u001b[0m \u001b[38;5;28mprint\u001b[39m(urls)\n\u001b[0;32m      7\u001b[0m \u001b[38;5;66;03m# Criando o objeto mainScrapper\u001b[39;00m\n\u001b[1;32m----> 8\u001b[0m mainScrapper \u001b[38;5;241m=\u001b[39m \u001b[43mScraper\u001b[49m\u001b[43m(\u001b[49m\u001b[43murls\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43m \u001b[49m\u001b[43murls\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m     10\u001b[0m \u001b[38;5;66;03m# Analisando os dados obtidos:\u001b[39;00m\n\u001b[0;32m     11\u001b[0m \u001b[38;5;28mlen\u001b[39m(mainScrapper\u001b[38;5;241m.\u001b[39mall_data)\n",
      "Cell \u001b[1;32mIn[15], line 14\u001b[0m, in \u001b[0;36mScraper.__init__\u001b[1;34m(self, urls)\u001b[0m\n\u001b[0;32m     12\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmaster_dict \u001b[38;5;241m=\u001b[39m {}\n\u001b[0;32m     13\u001b[0m \u001b[38;5;66;03m# Rodar o scrapper:\u001b[39;00m\n\u001b[1;32m---> 14\u001b[0m \u001b[43masyncio\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mrun\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mmain\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32mc:\\Users\\berna\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\asyncio\\runners.py:186\u001b[0m, in \u001b[0;36mrun\u001b[1;34m(main, debug)\u001b[0m\n\u001b[0;32m    161\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"Execute the coroutine and return the result.\u001b[39;00m\n\u001b[0;32m    162\u001b[0m \n\u001b[0;32m    163\u001b[0m \u001b[38;5;124;03mThis function runs the passed coroutine, taking care of\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    182\u001b[0m \u001b[38;5;124;03m    asyncio.run(main())\u001b[39;00m\n\u001b[0;32m    183\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[0;32m    184\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m events\u001b[38;5;241m.\u001b[39m_get_running_loop() \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    185\u001b[0m     \u001b[38;5;66;03m# fail fast with short traceback\u001b[39;00m\n\u001b[1;32m--> 186\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mRuntimeError\u001b[39;00m(\n\u001b[0;32m    187\u001b[0m         \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124masyncio.run() cannot be called from a running event loop\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    189\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m Runner(debug\u001b[38;5;241m=\u001b[39mdebug) \u001b[38;5;28;01mas\u001b[39;00m runner:\n\u001b[0;32m    190\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m runner\u001b[38;5;241m.\u001b[39mrun(main)\n",
      "\u001b[1;31mRuntimeError\u001b[0m: asyncio.run() cannot be called from a running event loop"
     ]
    }
   ],
   "source": [
    "# Selecionando as urls das páginas de medicamentos a partir do número de páginas totais\n",
    "n_páginas = 20\n",
    "base_url = \"https://www.drogasil.com.br/medicamentos.html?p=\"\n",
    "urls = [base_url + str(p) for p in range(1, n_páginas+1)]\n",
    "print(urls)\n",
    "\n",
    "# Criando o objeto mainScrapper\n",
    "mainScrapper = Scraper(urls = urls)\n",
    "\n",
    "# Analisando os dados obtidos:\n",
    "len(mainScrapper.all_data)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "912\n"
     ]
    }
   ],
   "source": [
    "href_set = set()\n",
    "for p in range(20):\n",
    "  url = \"https://www.drogasil.com.br/medicamentos.html?p=\" + str(p)\n",
    "  payload = {}\n",
    "  headers = {\n",
    "    'authority': 'www.drogasil.com.br',\n",
    "    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',\n",
    "    'accept-language': 'pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7',\n",
    "    'cache-control': 'no-cache',\n",
    "    'cookie': 'rrsession=h28ab332b1ca89150d91a; nav_id=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_p=20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_browserId=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_c=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_s=20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_anonymousUserId=anon-20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_testGroup=%7B%22experiment%22%3Anull%2C%22group%22%3Anull%2C%22testCode%22%3Anull%2C%22code%22%3Anull%2C%22session%22%3Anull%7D; guesttoken=ceksHPxt7i8UNdQcF6rFTOgbju2khBxJ; carttoken=ceksHPxt7i8UNdQcF6rFTOgbju2khBxJ; _gid=GA1.3.1680432160.1704587891; _rlu=47ba54e2-e976-4c22-87e4-e560bb2c4464; _rl_rl=0; _rlgm=7DD2zwA|y|11SvYaIv|z69E44GpO:y/k2DJBp5wr:y/k2B07zLgv:y/83Kqr1lP3:y/jY6vPp564:y/GRWzMj7JJ:y/XQpqOOPVl:y/r2V7glXWL:y/57K0OWEvx:y/oZXnvyODK:y/pZLoRznJ1:y/Br9YMo1rN:y/vQLyJQOyr:y/99YWAZ9lx:y/28Dm1NPyP:y/z6YM6PBq8:y|; _rllt=1704587891423; _rll_c_2267_d=1704587891429; _rll_c_2267_c=0; _rll_c_2267_sc=0; _rll_c_2267_sd=1704587891429; _tt_enable_cookie=1; _ttp=uzdapl01ydHOV-Bu2oxlWhhG0Lv; _pin_unauth=dWlkPU5URXhNVFJpT1RrdFpUUXhZUzAwT1RsbExXRTNPR0V0TVRKbFpEQXdOMlU1T0RVeA; _rlsnk=47ba_lr2rmci4; _gcl_au=1.1.1599598983.1704587894; blueID=c6fbd7b8-b313-4c10-9de6-ccfafc7504c1; user_unic_ac_id=8ceddb0d-c39c-cb32-463b-45e807d7f264; advcake_trackid=7aa5faa6-8b89-5bf6-59aa-1bd69c99aba0; OptanonAlertBoxClosed=2024-01-07T00:38:17.147Z; _rll__sel10s_d=1704587916581; _rll__sel10s_c=1; _rll__sel10s_sc=1; _rll__sel10s_sd=1704587916581; _rll__sel20s_d=1704587916584; _rll__sel20s_c=1; _rll__sel20s_sc=1; _rll__sel20s_sd=1704587916584; _rll_sc_1622_c=0; _rll__sel30s_d=1704588009841; _rll__sel30s_c=1; _rll__sel30s_sc=1; _rll__sel30s_sd=1704588009841; _rll__sel40s_d=1704588009843; _rll__sel40s_c=1; _rll__sel40s_sc=1; _rll__sel40s_sd=1704588009843; _rll__sel50s_d=1704588009845; _rll__sel50s_c=1; _rll__sel50s_sc=1; _rll__sel50s_sd=1704588009845; _rll__sel1m_d=1704588009846; _rll__sel1m_c=1; _rll__sel1m_sc=1; _rll__sel1m_sd=1704588009846; _rll_c_1813_d=1704588024848; _rll_c_1813_c=1; _rll_c_1813_sc=1; _rll_c_1813_sd=1704588024848; _rll__sel2m_d=1704588080161; _rll__sel2m_c=1; _rll__sel2m_sc=1; _rll__sel2m_sd=1704588080161; _hjSessionUser_557741=eyJpZCI6IjU2NDk4NDk0LWNjMDgtNWU3Mi05NWNkLWJlNjFmZGE1NjE3NiIsImNyZWF0ZWQiOjE3MDQ1ODgwMTIwOTksImV4aXN0aW5nIjp0cnVlfQ==; _rll__sel5m_d=1704593267364; _rll__sel5m_c=1; _rll__sel5m_sc=1; _rll__sel5m_sd=1704593267364; _rll__sel10m_d=1704593267365; _rll__sel10m_c=1; _rll__sel10m_sc=1; _rll__sel10m_sd=1704593267365; _rll__sel30m_d=1704593267366; _rll__sel30m_c=1; _rll__sel30m_sc=1; _rll__sel30m_sd=1704593267366; _rll__sel60m_d=1704593267367; _rll__sel60m_c=1; _rll__sel60m_sc=1; _rll__sel60m_sd=1704593267367; rcsicons=eF4Vx7sNgDAQBNHEEb2sdMt9fHRAGzZOCMiA-jEa6UlTluu9zyHUVLCKxV-k-DyA5Tn2xq1n1QFzKsyYyNEIkVBNt3X6AWWbEGw; mmapi.p.bid=%22prodiadcgus02%22; mmapi.p.srv=%22prodiadcgus02%22; rcsproducts=eF4Vx7ERgDAIBdAmlbv8uxAIgQ1cQyGFhZ06v3qvemU5n-vISmwMGlX0Z_qtC0DljnWLpvvMgXDfIG0GqmcHmTJbFwrPF4KDEdI; impulsesuite_session=1704646471995-0.10658159894229269; chaordic_session=1704646472287-0.06931777319778276; _rll_c_1622_d=1704646473999; _rll_c_1622_sc=2; _rll_c_1622_sd=1704646473999; _rll_c_1622_c=0; _hjIncludedInSessionSample_557741=0; _hjSession_557741=eyJpZCI6IjFkZDYxMDM5LWI0NjAtNGYwMi1iZmJhLTBkNmE1ZWFmYzE3MCIsImMiOjE3MDQ2NDY1MjMxMzAsInMiOjAsInIiOjAsInNiIjowfQ==; _hjAbsoluteSessionInProgress=0; rcspdp=eF4NxLENgDAMBMAmFbs8wvZjOxswRwiRKOiA-eGKK-XZt9Fr09UVzEGwtr_MgNLNMpocotP13mefxdIgsdDp6WpqICAfbDEQqQ; mmapi.p.pd=%22dt2xbRiKUUDUSN1thEBCy_6hE3opjyWfV_lH5uI8PIw%3D%7CHgAAAApDH4sIAAAAAAAEAGNheD4pcJq7xM49DMyZiSmMQgyMTgwqTLNfsDEsPL6yYhH_HY-izRqvJIA0AxD8hwIGNpfMotTkEkZ3CTaQOBjAJEE0VIjRFQA25gtUYQAAAA%3D%3D%22; _ga=GA1.1.1543159432.1704587890; _ga_5J2QJPHWJP=GS1.1.1704646471.6.1.1704646973.35.0.0; cto_bundle=oHRiD19ZalZNVllDJTJCTWQyRXMwVzdvaFluN0JCVTJnZ1NPbElKdzBmTEl1WHRub255MHN6SXEwSXF4VUJLdDRodHJJZXJIV1pDc2d4VE9seWV2Z1lOUlglMkZWcUdVSVNGSWlXR2lSSXBJeWJvaXF2YlJTbTk5ckhXUFozMlJ2c1Y3NllKTFZqd1VnVnhCUkIxTm5wdCUyQmtWSFBXJTJCdzZpZXoxUFYlMkY4TEQwTG9mMXFQTW8zOWJZV01JdnJQaEJPM1JaWElnbDI1MXJ4TThtVkVFcHdZdjFja1B2Z1ByQVdpciUyRmg5WmRvYk4zZUdBU2d4M1FtQWhyJTJGZXJPaXhBbkJUdGtQOVpKc2UyY3RMcTdSOG9FR2RhWUIlMkZ4ZVM1QSUyRk0lMkY4cG41cDBMTG8lMkJaSUw2ODllOFZUdUxFeGhKJTJCSmJOM05tdmhPOFBaSQ; OptanonConsent=isIABGlobal=false&datestamp=Sun+Jan+07+2024+14%3A02%3A54+GMT-0300+(Brasilia+Standard+Time)&version=6.22.0&hosts=&consentId=af2697d4-7a7e-43f2-a718-4ffd2dcf34e5&interactionCount=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0002%3A1%2CC0003%3A1%2CC0004%3A1%2CC0008%3A1&geolocation=BR%3BSP&AwaitingReconsent=false; _dc_gtm_UA-69376920-3=1; _dd_s=rum=0&expire=1704648022438; rcspdp=eF5j4cotK8lM0TM0tjDWNTQ3MDEzNjU2MzIwMNI10dU1ZClN9khLsUwyMjUDClikmeiaWCYBCQsLc10joFpjC_Mkw1RDIwBZ5RCc',\n",
    "    'pragma': 'no-cache',\n",
    "    'sec-ch-ua': '\"Not_A Brand\";v=\"8\", \"Chromium\";v=\"120\", \"Google Chrome\";v=\"120\"',\n",
    "    'sec-ch-ua-mobile': '?0',\n",
    "    'sec-ch-ua-platform': '\"Windows\"',\n",
    "    'sec-fetch-dest': 'document',\n",
    "    'sec-fetch-mode': 'navigate',\n",
    "    'sec-fetch-site': 'same-origin',\n",
    "    'sec-fetch-user': '?1',\n",
    "    'upgrade-insecure-requests': '1',\n",
    "    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'\n",
    "  }\n",
    "\n",
    "  response = requests.request(\"GET\", url, headers=headers, data=payload)\n",
    "  soup = BeautifulSoup(response.text, 'html.parser')\n",
    "  div_with_href = soup.find('div', {'class': 'ProductGridstyles__ProductGridStyles-tflwc1-0 gquykZ'})\n",
    "  if div_with_href:\n",
    "      href_tags = div_with_href.find_all('a', {'class': 'LinkNextstyles__LinkNextStyles-t73o01-0 cpRdBZ LinkNext'})\n",
    "      href_set.update({tag.get('href') for tag in href_tags if tag.get('href') is not None})\n",
    "  else:\n",
    "      print(\"Div not found or doesn't have the specified class.\")\n",
    "\n",
    "\n",
    "print(len(href_set))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [],
   "source": [
    "html_produtos = []\n",
    "for dominio in href_set:\n",
    "    url = dominio\n",
    "    payload = {}\n",
    "    headers = {\n",
    "    'authority': 'www.drogasil.com.br',\n",
    "    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',\n",
    "    'accept-language': 'pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7',\n",
    "    'cache-control': 'no-cache',\n",
    "    'cookie': 'rrsession=h28ab332b1ca89150d91a; nav_id=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_p=20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_browserId=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_c=20209ead-3f78-41b4-8ef9-91c8e9de46ab; legacy_s=20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_anonymousUserId=anon-20209ead-3f78-41b4-8ef9-91c8e9de46ab; chaordic_testGroup=%7B%22experiment%22%3Anull%2C%22group%22%3Anull%2C%22testCode%22%3Anull%2C%22code%22%3Anull%2C%22session%22%3Anull%7D; guesttoken=ceksHPxt7i8UNdQcF6rFTOgbju2khBxJ; carttoken=ceksHPxt7i8UNdQcF6rFTOgbju2khBxJ; _gid=GA1.3.1680432160.1704587891; _rlu=47ba54e2-e976-4c22-87e4-e560bb2c4464; _rl_rl=0; _rlgm=7DD2zwA|y|11SvYaIv|z69E44GpO:y/k2DJBp5wr:y/k2B07zLgv:y/83Kqr1lP3:y/jY6vPp564:y/GRWzMj7JJ:y/XQpqOOPVl:y/r2V7glXWL:y/57K0OWEvx:y/oZXnvyODK:y/pZLoRznJ1:y/Br9YMo1rN:y/vQLyJQOyr:y/99YWAZ9lx:y/28Dm1NPyP:y/z6YM6PBq8:y|; _rllt=1704587891423; _rll_c_2267_d=1704587891429; _rll_c_2267_c=0; _rll_c_2267_sc=0; _rll_c_2267_sd=1704587891429; _tt_enable_cookie=1; _ttp=uzdapl01ydHOV-Bu2oxlWhhG0Lv; _pin_unauth=dWlkPU5URXhNVFJpT1RrdFpUUXhZUzAwT1RsbExXRTNPR0V0TVRKbFpEQXdOMlU1T0RVeA; _rlsnk=47ba_lr2rmci4; _gcl_au=1.1.1599598983.1704587894; blueID=c6fbd7b8-b313-4c10-9de6-ccfafc7504c1; user_unic_ac_id=8ceddb0d-c39c-cb32-463b-45e807d7f264; advcake_trackid=7aa5faa6-8b89-5bf6-59aa-1bd69c99aba0; OptanonAlertBoxClosed=2024-01-07T00:38:17.147Z; _rll__sel10s_d=1704587916581; _rll__sel10s_c=1; _rll__sel10s_sc=1; _rll__sel10s_sd=1704587916581; _rll__sel20s_d=1704587916584; _rll__sel20s_c=1; _rll__sel20s_sc=1; _rll__sel20s_sd=1704587916584; _rll_sc_1622_c=0; _rll__sel30s_d=1704588009841; _rll__sel30s_c=1; _rll__sel30s_sc=1; _rll__sel30s_sd=1704588009841; _rll__sel40s_d=1704588009843; _rll__sel40s_c=1; _rll__sel40s_sc=1; _rll__sel40s_sd=1704588009843; _rll__sel50s_d=1704588009845; _rll__sel50s_c=1; _rll__sel50s_sc=1; _rll__sel50s_sd=1704588009845; _rll__sel1m_d=1704588009846; _rll__sel1m_c=1; _rll__sel1m_sc=1; _rll__sel1m_sd=1704588009846; _rll_c_1813_d=1704588024848; _rll_c_1813_c=1; _rll_c_1813_sc=1; _rll_c_1813_sd=1704588024848; _rll__sel2m_d=1704588080161; _rll__sel2m_c=1; _rll__sel2m_sc=1; _rll__sel2m_sd=1704588080161; _hjSessionUser_557741=eyJpZCI6IjU2NDk4NDk0LWNjMDgtNWU3Mi05NWNkLWJlNjFmZGE1NjE3NiIsImNyZWF0ZWQiOjE3MDQ1ODgwMTIwOTksImV4aXN0aW5nIjp0cnVlfQ==; _rll__sel5m_d=1704593267364; _rll__sel5m_c=1; _rll__sel5m_sc=1; _rll__sel5m_sd=1704593267364; _rll__sel10m_d=1704593267365; _rll__sel10m_c=1; _rll__sel10m_sc=1; _rll__sel10m_sd=1704593267365; _rll__sel30m_d=1704593267366; _rll__sel30m_c=1; _rll__sel30m_sc=1; _rll__sel30m_sd=1704593267366; _rll__sel60m_d=1704593267367; _rll__sel60m_c=1; _rll__sel60m_sc=1; _rll__sel60m_sd=1704593267367; rcsicons=eF4Vx7sNgDAQBNHEEb2sdMt9fHRAGzZOCMiA-jEa6UlTluu9zyHUVLCKxV-k-DyA5Tn2xq1n1QFzKsyYyNEIkVBNt3X6AWWbEGw; mmapi.p.srv=%22prodiadcgus02%22; rcsproducts=eF4Vx7ERgDAIBdAmlbv8uxAIgQ1cQyGFhZ06v3qvemU5n-vISmwMGlX0Z_qtC0DljnWLpvvMgXDfIG0GqmcHmTJbFwrPF4KDEdI; impulsesuite_session=1704646471995-0.10658159894229269; chaordic_session=1704646472287-0.06931777319778276; _rll_c_1622_d=1704646473999; _rll_c_1622_sc=2; _rll_c_1622_sd=1704646473999; _rll_c_1622_c=0; _hjIncludedInSessionSample_557741=0; _hjSession_557741=eyJpZCI6IjFkZDYxMDM5LWI0NjAtNGYwMi1iZmJhLTBkNmE1ZWFmYzE3MCIsImMiOjE3MDQ2NDY1MjMxMzAsInMiOjAsInIiOjAsInNiIjowfQ==; _hjAbsoluteSessionInProgress=0; rcspdp=eF4NxLENgDAMBMAmFbs8wvZjOxswRwiRKOiA-eGKK-XZt9Fr09UVzEGwtr_MgNLNMpocotP13mefxdIgsdDp6WpqICAfbDEQqQ; mmapi.p.pd=%221bjcoO6odHojz0QfNW01v6keFtIMK7MCahm__uoj_mY%3D%7CHwAAAApDH4sIAAAAAAAEAGNheD4pcJq7xM49DMyZiSmMQgyMTgwqTLNfsDH4uPy6voj_jkfRZo1XEkCaAQj-QwEDm0tmUWpyCaO7BBtIHAxgkiAaKsToCgBcOxKHYQAAAA%3D%3D%22; _ga=GA1.1.1543159432.1704587890; OptanonConsent=isIABGlobal=false&datestamp=Sun+Jan+07+2024+14%3A05%3A36+GMT-0300+(Brasilia+Standard+Time)&version=6.22.0&hosts=&consentId=af2697d4-7a7e-43f2-a718-4ffd2dcf34e5&interactionCount=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0002%3A1%2CC0003%3A1%2CC0004%3A1%2CC0008%3A1&geolocation=BR%3BSP&AwaitingReconsent=false; cto_bundle=ir-aNV9ZalZNVllDJTJCTWQyRXMwVzdvaFluN0FGYjdrNGklMkZ3aHNINE9BMDE0M2N3TG5qS2JHTGMwMTZCVFF4dHhlbG8xazBvRU1mWEtCdVdFS0taaWN6V3FhdllPYTJ2OEZ3WUx3Z0hWRWpCQk4lMkJCclVJSkJJV3JFWGVoQ2R3NWpsWDV3eWpzYSUyRmxIc1RTMnpWSmg3RlZOSCUyRmwyTTk5ZmZTcTQzOGU5M21uVVlqVnZlRGx3Z2prYk1pVFlVeTFodm1YOFhXbmc1QUQ3SkxMTWtuekxHVVhNTURBdlAwUkolMkZuS2sxSU1TTTY0MGFzdyUyRjBPRVRlSTNOJTJGZFQyRllGbUs3ZWVsQ1NCTnpmUVIlMkJvN1FmMWY2eGdpbEtpWmh1NCUyQlpjcFpHTHBBUVptb2dJQiUyRjAwMVQzJTJGQ2o1NUpRdiUyQmFDaFE0bDVp; _dc_gtm_UA-69376920-3=1; _ga_5J2QJPHWJP=GS1.1.1704646471.6.1.1704647882.57.0.0; _dd_s=rum=0&expire=1704648782707; rcspdp=eF4NxDESgCAMBMCGyr-cQ5KDhB_4DkRmLOzU9-sWm5brvc-xioVBPLPSm0rJBgKSnn2bo3UtVcGYBFv_i3Aoq1l4l0P0A1vZEKY',\n",
    "    'pragma': 'no-cache',\n",
    "    'referer': 'https://www.drogasil.com.br/medicamentos.html',\n",
    "    'sec-ch-ua': '\"Not_A Brand\";v=\"8\", \"Chromium\";v=\"120\", \"Google Chrome\";v=\"120\"',\n",
    "    'sec-ch-ua-mobile': '?0',\n",
    "    'sec-ch-ua-platform': '\"Windows\"',\n",
    "    'sec-fetch-dest': 'document',\n",
    "    'sec-fetch-mode': 'navigate',\n",
    "    'sec-fetch-site': 'same-origin',\n",
    "    'sec-fetch-user': '?1',\n",
    "    'upgrade-insecure-requests': '1',\n",
    "    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'\n",
    "    }\n",
    "\n",
    "    response = requests.request(\"GET\", url, headers=headers, data=payload)\n",
    "    html_produtos.append(response.text)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Colunas da Tabela:\n",
    "df_sku = []\n",
    "df_ean = []\n",
    "df_cidade = []\n",
    "df_produto = []\n",
    "df_marca = []\n",
    "df_farmacia = [] \n",
    "df_preco_com_desconto = []\n",
    "df_preco_sem_desconto = []\n",
    "df_perc_de_desconto = []\n",
    "df_descricao = []\n",
    "df_regiao = []\n",
    "\n",
    "for html_produto in html_produtos:\n",
    "\n",
    "    #Valores neutros:\n",
    "    sku_value = 'Sem SKU'\n",
    "    ean_value = 'Sem EAN'\n",
    "    marca = 'Sem marca'\n",
    "    value_from = None\n",
    "    value_to = None\n",
    "    nome_produto = None\n",
    "\n",
    "    soup = BeautifulSoup(html_produto, 'html.parser')\n",
    "    \n",
    "    #extração da descrição\n",
    "    product_description_div = soup.find('div', {'class': 'ProductDescriptionstyles__ProductDescriptionStyle-sc-17jtyta-0 eErzFZ'})\n",
    "    if product_description_div:\n",
    "        # Extrair todo o texto dentro da div\n",
    "        description_text = product_description_div.get_text(strip=True)\n",
    "    else:\n",
    "        description_text = 'sem descricao'\n",
    "    df_descricao.append(description_text)\n",
    "\n",
    "    #extração do sku, ean e marca:\n",
    "    th_tags = soup.find_all('th')\n",
    "    for th in th_tags:\n",
    "        if th.text.strip() == 'SKU':\n",
    "            td_tag = th.find_next('td')\n",
    "            if td_tag:\n",
    "                div_tag = td_tag.find('div')\n",
    "                if div_tag:\n",
    "                    sku_value = div_tag.text.strip()\n",
    "        if th.text.strip() == 'EAN':\n",
    "            td_tag = th.find_next('td')\n",
    "            if td_tag:\n",
    "                div_tag = td_tag.find('div')\n",
    "                if div_tag:\n",
    "                    ean_value = div_tag.text.strip()\n",
    "        if th.text.strip() == 'Marca':\n",
    "            td_tag = th.find_next('td')\n",
    "            if td_tag:\n",
    "                a_tag = td_tag.find('a')\n",
    "                if a_tag:\n",
    "                    marca = a_tag.text.strip()\n",
    "    df_sku.append(sku_value)\n",
    "    df_ean.append(ean_value)\n",
    "    df_marca.append(marca)\n",
    "    \n",
    "    #extração do preço com e sem desconto:\n",
    "    scripts = soup.find_all('script')\n",
    "    for script in scripts:\n",
    "        if script.get('id') == '__NEXT_DATA__' and script.get('type') == 'application/json':\n",
    "            json_data = json.loads(script.string)\n",
    "            value_from = json_data['props']['pageProps']['pageData']['productData']['productBySku']['price_aux']['value_from']\n",
    "            value_to = json_data['props']['pageProps']['pageData']['productData']['productBySku']['price_aux']['value_to']\n",
    "            nome_produto = json_data['props']['pageProps']['pageQuery']['title']\n",
    "    df_preco_sem_desconto.append(value_from)\n",
    "    df_preco_com_desconto.append(value_to)\n",
    "    df_produto.append(nome_produto)\n",
    "    \n",
    "    #calculo do percentual de desconto:\n",
    "    if value_from is not None and value_to is not None:\n",
    "        desconto = (value_from - value_to) * 100 / value_from\n",
    "    else:\n",
    "        desconto = None\n",
    "    df_perc_de_desconto.append(desconto)\n",
    "\n",
    "    #por default, vamos estabelecer alguns dados:\n",
    "    df_cidade.append('São Paulo')\n",
    "    df_regiao.append('SE')\n",
    "    df_farmacia.append('Drogasil')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Tamanho de df_sku: 912\n",
      "Tamanho de df_ean: 912\n",
      "Tamanho de df_cidade: 912\n",
      "Tamanho de df_produto: 912\n",
      "Tamanho de df_marca: 912\n",
      "Tamanho de df_farmacia: 912\n",
      "Tamanho de df_preco_com_desconto: 912\n",
      "Tamanho de df_preco_sem_desconto: 912\n",
      "Tamanho de df_perc_de_desconto: 912\n",
      "Tamanho de df_descricao: 912\n",
      "Tamanho de df_regiao: 912\n"
     ]
    }
   ],
   "source": [
    "print(\"Tamanho de df_sku:\", len(df_sku))\n",
    "print(\"Tamanho de df_ean:\", len(df_ean))\n",
    "print(\"Tamanho de df_cidade:\", len(df_cidade))\n",
    "print(\"Tamanho de df_produto:\", len(df_produto))\n",
    "print(\"Tamanho de df_marca:\", len(df_marca))\n",
    "print(\"Tamanho de df_farmacia:\", len(df_farmacia))\n",
    "print(\"Tamanho de df_preco_com_desconto:\", len(df_preco_com_desconto))\n",
    "print(\"Tamanho de df_preco_sem_desconto:\", len(df_preco_sem_desconto))\n",
    "print(\"Tamanho de df_perc_de_desconto:\", len(df_perc_de_desconto))\n",
    "print(\"Tamanho de df_descricao:\", len(df_descricao))\n",
    "print(\"Tamanho de df_regiao:\", len(df_regiao))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Região</th>\n",
       "      <th>Cidade</th>\n",
       "      <th>Farmácia</th>\n",
       "      <th>Produto</th>\n",
       "      <th>EAN</th>\n",
       "      <th>SKU</th>\n",
       "      <th>Preço sem Desconto</th>\n",
       "      <th>Preço com Desconto</th>\n",
       "      <th>Percentual de Desconto</th>\n",
       "      <th>Descrição</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>SE</td>\n",
       "      <td>São Paulo</td>\n",
       "      <td>Drogasil</td>\n",
       "      <td>Colírio Optive com 10ml: Preço, para que serve...</td>\n",
       "      <td>7897316805114</td>\n",
       "      <td>26656</td>\n",
       "      <td>65.09</td>\n",
       "      <td>51.52</td>\n",
       "      <td>20.848057</td>\n",
       "      <td>Descrição do ProdutoPara que serve o Colírio O...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>SE</td>\n",
       "      <td>São Paulo</td>\n",
       "      <td>Drogasil</td>\n",
       "      <td>Atenolol 25mg EMS 60 comprimidos - preço e par...</td>\n",
       "      <td>7896004705880</td>\n",
       "      <td>21320</td>\n",
       "      <td>38.83</td>\n",
       "      <td>4.85</td>\n",
       "      <td>87.509657</td>\n",
       "      <td>Descrição do ProdutoPara que serve o Atenolol?...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>SE</td>\n",
       "      <td>São Paulo</td>\n",
       "      <td>Drogasil</td>\n",
       "      <td>Carvedilol 12,5mg Aché Biosintética 30 comprim...</td>\n",
       "      <td>7896181915041</td>\n",
       "      <td>20946</td>\n",
       "      <td>56.29</td>\n",
       "      <td>19.31</td>\n",
       "      <td>65.695505</td>\n",
       "      <td>Descrição do ProdutoPara que serve o Carvedilo...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>SE</td>\n",
       "      <td>São Paulo</td>\n",
       "      <td>Drogasil</td>\n",
       "      <td>Cloridrato de Fluoxetina 20mg 28 Cápsulas Euro...</td>\n",
       "      <td>7891317160920</td>\n",
       "      <td>14492</td>\n",
       "      <td>54.12</td>\n",
       "      <td>16.09</td>\n",
       "      <td>70.269771</td>\n",
       "      <td>Descrição do ProdutoPara que serve o Cloridrat...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>SE</td>\n",
       "      <td>São Paulo</td>\n",
       "      <td>Drogasil</td>\n",
       "      <td>Desogestrel 150mcg + Etinilestradiol 20mcg 21 ...</td>\n",
       "      <td>7891317448936</td>\n",
       "      <td>68650</td>\n",
       "      <td>36.61</td>\n",
       "      <td>12.69</td>\n",
       "      <td>65.337340</td>\n",
       "      <td>Descrição do ProdutoPara que serve o Desogestr...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Região     Cidade  Farmácia  \\\n",
       "0     SE  São Paulo  Drogasil   \n",
       "1     SE  São Paulo  Drogasil   \n",
       "2     SE  São Paulo  Drogasil   \n",
       "3     SE  São Paulo  Drogasil   \n",
       "4     SE  São Paulo  Drogasil   \n",
       "\n",
       "                                             Produto            EAN    SKU  \\\n",
       "0  Colírio Optive com 10ml: Preço, para que serve...  7897316805114  26656   \n",
       "1  Atenolol 25mg EMS 60 comprimidos - preço e par...  7896004705880  21320   \n",
       "2  Carvedilol 12,5mg Aché Biosintética 30 comprim...  7896181915041  20946   \n",
       "3  Cloridrato de Fluoxetina 20mg 28 Cápsulas Euro...  7891317160920  14492   \n",
       "4  Desogestrel 150mcg + Etinilestradiol 20mcg 21 ...  7891317448936  68650   \n",
       "\n",
       "   Preço sem Desconto  Preço com Desconto  Percentual de Desconto  \\\n",
       "0               65.09               51.52               20.848057   \n",
       "1               38.83                4.85               87.509657   \n",
       "2               56.29               19.31               65.695505   \n",
       "3               54.12               16.09               70.269771   \n",
       "4               36.61               12.69               65.337340   \n",
       "\n",
       "                                           Descrição  \n",
       "0  Descrição do ProdutoPara que serve o Colírio O...  \n",
       "1  Descrição do ProdutoPara que serve o Atenolol?...  \n",
       "2  Descrição do ProdutoPara que serve o Carvedilo...  \n",
       "3  Descrição do ProdutoPara que serve o Cloridrat...  \n",
       "4  Descrição do ProdutoPara que serve o Desogestr...  "
      ]
     },
     "execution_count": 101,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.DataFrame({\n",
    "    'Região': df_regiao,\n",
    "    'Cidade': df_cidade,\n",
    "    'Farmácia': df_farmacia,\n",
    "    'Produto': df_produto,\n",
    "    'EAN': df_ean,\n",
    "    'SKU': df_sku,\n",
    "    'Preço sem Desconto': df_preco_sem_desconto,\n",
    "    'Preço com Desconto': df_preco_com_desconto,\n",
    "    'Percentual de Desconto': df_perc_de_desconto,\n",
    "    'Descrição': df_descricao\n",
    "})\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('drogasil_teste.csv',index=False)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
